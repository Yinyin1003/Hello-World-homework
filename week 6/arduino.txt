#include <Joystick.h>

int xPin = A0;  // Joystick X 轴连接的引脚
int yPin = A1;  // Joystick Y 轴连接的引脚
int buttonPin = 7; // 控制小鱼转向的按钮连接的引脚

int xValue, yValue;
int buttonState = 0;
int lastButtonState = 0;

void setup() {
  Serial.begin(9600);
  pinMode(buttonPin, INPUT_PULLUP);  // 设置按钮引脚为输入
}

void loop() {
  // 读取 Joystick 的 X 和 Y 值
  xValue = analogRead(xPin);
  yValue = analogRead(yPin);

  // 读取按钮状态
  buttonState = digitalRead(buttonPin);

  // 将 Joystick 和按钮的数据发送给 p5.js
  Serial.print("X:");
  Serial.print(xValue);
  Serial.print(",Y:");
  Serial.print(yValue);
  
  // 如果按钮状态变化了，发送状态
  if (buttonState == LOW && lastButtonState == HIGH) {
    Serial.println(",B:1");
  } else {
    Serial.println(",B:0");
  }
  
  lastButtonState = buttonState;

  delay(100);
}
